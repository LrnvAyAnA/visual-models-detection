# Проектные решения для API системы распознавания визуальных моделей

## 1. Архитектура API

API разработан в соответствии с принципами RESTful. Каждое действие связано с конкретным ресурсом, а HTTP-методы (GET, POST, PUT, DELETE) определяют тип операции над ресурсом.

## 2. Формат данных

Все данные передаются и возвращаются в формате JSON. Это обеспечивает читаемость данных и легкость их обработки на клиентской стороне.

## 3. Эндпоинты

Эндпоинты организованы по ресурсам. Для ресурсов предусмотрены стандартные CRUD-операции:

- `/images`: управление загружаемыми изображениями.
- `/results`: доступ к результатам распознавания.
- `/nodes`: работа с отдельными узлами диаграммы.

## 4. Методы API

Для взаимодействия с API используются следующие методы:

- **GET**: получение данных.
- **POST**: создание нового ресурса.
- **PUT**: обновление существующего ресурса.
- **DELETE**: удаление ресурса.

## 5. Стандарты HTTP-ответов

Для работы с API предусмотрены стандартизированные коды и сообщения:

- **200 OK**: успешная операция.
- **201 Created**: ресурс успешно создан.
- **400 Bad Request**: ошибка в запросе клиента.
- **404 Not Found**: запрашиваемый ресурс не найден.

## 6. Валидация входных данных
Реализована проверка корректности входных данных в методах POST и PUT. Например:

- Проверяется наличие обязательных полей (image_id, format) для экспорта.
- Формат данных проверяется на соответствие (например, число вместо строки).

## 7. Гибкость API (расширяемость)
Принято решение заложить возможность добавления новых форматов экспорта (например, PlantUML). Для этого добавлен эндпоинт /results/export, где параметр format может быть расширен.

## 8. Простое хранилище данных
На текущем этапе используется простая структура в виде Python-словаря (data = {}). Это облегчает разработку и тестирование. В будущем возможно подключение базы данных (например, PostgreSQL) для хранения и управления данными.

## 9. Тестирование API через Postman
Для проверки корректной работы всех методов API было принято решение использовать Postman. Это позволяет протестировать запросы, увидеть ответы сервера и зафиксировать результаты.

# Документация по API
Данные передаются в формате `JSON`. Ответы от API также возвращаются в формате `JSON`.

## Реализуемое API
### 1. Загрузка изображения

Метод: `POST`

URL: `/images`

Описание: Создает новое изображение в хранилище. Возвращает уникальный `image_id` для созданного изображения.

Пример запроса:

`http://127.0.0.1:5000/images`

Пример ответа:

```
{
    "image_id": 1,
    "status": "uploaded"
}
```
### 2. Получение данных об изображении

Метод: `GET`

URL: `/results/<image_id>`

Описание: Возвращает информацию об изображении, включая узлы (`nodes`) и соединения (`connections`).

Коды ответа:

`200 OK`: Данные успешно получены.

`404 Not Found`: Изображение с указанным image_id не найдено.

Пример запроса:

`http://127.0.0.1:5000/results/1`

Пример ответа:

```
{
    "connections": [],
    "nodes": [
        {
            "id": 1,
            "name": "Decision Node",
            "type": "Decision"
        }
    ]
}
```

### 3. Создание узла

Метод: `POST`

URL: `/results/<image_id>/nodes`

Описание: Добавляет новый узел к изображению.

Коды ответа:

`201 Created`: Узел успешно создан.

`404 Not Found`: Изображение с указанным `image_id` не найдено.

Пример запроса:

`http://127.0.0.1:5000/results/1/nodes`

Тело запроса:

```
{
  "name": "Decision Node",
  "type": "Decision"
}
```

Пример ответа:

```
{
    "node": {
        "id": 1,
        "name": "Decision Node",
        "type": "Decision"
    },
    "status": "created"
}
```

### 4. Обновление узла
Метод: `PUT`

URL: `/results/<image_id>/nodes/<node_id>`

Описание: Обновляет информацию об узле с указанным `node_id` в заданном изображении.

Коды ответа:

`200 OK`: Узел успешно обновлен.

`404 Not Found`: Изображение или узел с указанными `image_id` и `node_id` не найдены.

Пример запроса:

`http://127.0.0.1:5000/results/1/nodes/3`

Тело запроса:

```
{
  "name": "Updated Decision Node",
  "type": "Updated Type"
}
```

Пример ответа:

```
{
  "status": "updated"
}
```

### 5. Удаление изображения

Метод: `DELETE`

URL: `/results/<image_id>`

Описание: Удаляет изображение с указанным `image_id` из хранилища.

Коды ответа:

`200 OK`: Изображение успешно удалено.

`404 Not Found`: Изображение с указанным `image_id` не найдено.

Пример запроса:

`http://127.0.0.1:5000/results/1`

Пример ответа:

```
{
  "status": "deleted"
}
```

### 6. Получение данных об узле

Метод: `GET`

URL: `/nodes/<node_id>`

Описание: Возвращает информацию об узле с указанным `node_id`.

Коды ответа:

`200 OK`: Узел успешно найден.

`404 Not Found`: Узел с указанным `node_id` не найден.

Пример запроса:

`http://127.0.0.1:5000/nodes/3`

Пример ответа:

```
{
  "id": 3,
  "name": "Updated Decision Node",
  "type": "Updated Type"
}
```

### 7. Экспорт результатов

Метод: `POST`

URL: `/results/export`

Описание: Экспортирует данные изображения в заданном формате (по умолчанию — JSON).

Коды ответа:

`200 OK`: Данные успешно экспортированы.

`404 Not Found`: Изображение с указанным `image_id` не найдено.

`400 Bad Request`: Указан неподдерживаемый формат.

Пример запроса:

`http://127.0.0.1:5000/results/export`

Тело запроса:

```
{
  "image_id": 1,
  "format": "json"
}
```

Пример ответа:

```
{
    "data": {
        "connections": [],
        "nodes": []
    },
    "status": "exported"
}
```

### 8. Удаление узла

Метод: `DELETE`

URL: `/nodes/<node_id>`

Описание: Удаляет узел с указанным `node_id` из базы данных. Если узел связан с другими элементами, связи также удаляются.

Коды ответа:

`200 OK` – Узел удалён.

`404 Not Found` – Узел не найден.

Пример запроса:

`http://127.0.0.1:5000/nodes/3`

Пример ответа:

```
{
    "status": "Node deleted"
}
```

## Тестирование API
### 1. Загрузка изображения

Метод: `POST`

URL: `/images`

![image](https://github.com/user-attachments/assets/901316f3-8740-4523-b3d9-ad80f26187df)

### 2. Получение данных об изображении

Метод: `GET`

URL: `/results/<image_id>`

![image](https://github.com/user-attachments/assets/75ff62f9-57b8-4f67-a9d0-2fe4026725d9)

### 3. Создание узла

Метод: `POST`

URL: `/results/<image_id>/nodes`

![image](https://github.com/user-attachments/assets/f0fffaa8-7689-4f83-bb60-60b612cf80a8)

### 4. Обновление узла
Метод: `PUT`

URL: `/results/<image_id>/nodes/<node_id>`

![image](https://github.com/user-attachments/assets/af9cba78-6cf3-48ed-862d-1ab4cd807265)

### 5. Удаление изображения

Метод: `DELETE`

URL: `/results/<image_id>`

![image](https://github.com/user-attachments/assets/4d883868-f93a-412b-89cc-77d332d08b01)

### 6. Получение данных об узле

Метод: `GET`

URL: `/nodes/<node_id>`

![image](https://github.com/user-attachments/assets/fe0d8806-3b49-4236-9977-ec49afc31e0c)

### 7. Экспорт результатов

Метод: `POST`

URL: `/results/export`

![image](https://github.com/user-attachments/assets/24cd1709-36c2-452c-9554-4ce40557758a)

### 8. Удаление узла

Метод: `DELETE`

URL: `/nodes/<node_id>`

![image](https://github.com/user-attachments/assets/d6a7809f-81ec-4461-9f50-d61e4fb28a86)
